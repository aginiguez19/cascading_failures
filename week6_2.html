<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Abraham Iñiguez and Marwin Carmo">

<title>Cascading Failures</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="week6_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="week6_2_files/libs/quarto-html/quarto.js"></script>
<script src="week6_2_files/libs/quarto-html/popper.min.js"></script>
<script src="week6_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="week6_2_files/libs/quarto-html/anchor.min.js"></script>
<link href="week6_2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="week6_2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="week6_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="week6_2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="week6_2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="week6_2_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="week6_2_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="week6_2_files/libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="week6_2_files/libs/vis-9.1.0/vis-network.min.js"></script>
<script src="week6_2_files/libs/visNetwork-binding-2.1.2/visNetwork.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Cascading Failures</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Abraham Iñiguez and Marwin Carmo </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="failures-in-graphs" class="level1">
<h1>Failures in graphs?</h1>
<p>Well established in this class is the fact that graphs are made up of nodes (components) and edges (links). We have many real-world examples of graphs to take from: the internet, power grids, ecology, physiology, and of course psychological systems.</p>
<<<<<<< HEAD
<p>In these networks often times we see the interplay of processes internal and external to the system. Think of a transmission line malfunctioning in an electrical power grid. Or possibly a perturbation to a system that disrupts communication among nodes. These two examples hint at an important dynamical process termed cascading failure or avalanche (if you’re feeling fancy). Although rare, they can have severe consequences. In general, a cascading failure refers to some trigger mechanism that produces further failures in the system which ultimately may lead to a complete collapse of the system <span class="citation" data-cites="valdez2020jcn">(<a href="#ref-valdez2020jcn" role="doc-biblioref">Valdez et al., 2020</a>)</span>. Further failures occur because components vary in their ability to handle a certain load that is redistributed to them after an initial failure.</p>
<p>Similarly, in social systems we might think of a cascading failure being dependent on the information other people may have and subsequently their decisions. This is quite common in fads or things that are “hyped-up”. We might choose to wear Levi jeans because many of our peers are wearing Levi jeans. We might choose to see one movie over another based on reviews or recommendations by friends. Economists define these scenarios as <em>binary decisions with externalities</em> <span class="citation" data-cites="watts2002p">(<a href="#ref-watts2002p" role="doc-biblioref">Watts, 2002</a>)</span>. Important to note is that a personal threshold must be reached before a transition occurs in conjunction with what others have decided. Furthermore, rather than components failing it is a component transitioning from one state to another.</p>
<!-- Similarly, in social systems we might think of a cascading failure being dependent on the information other people may have and subsequently their decisions. This is quite common in fads or things that are "hyped-up". We might choose to wear Levi jeans because many of our peers are wearing Levi jeans. We might choose to see one movie over another based on reviews or recommendations by friends. Economists define these scenarios as *binary decisions with externalities*[@watts2002p]. Important to note is that a personal threshold must be reached before a transition occurs in conjunction with what others have decided. Furthermore, rather than components failing it is a component transitioning from one state to another. -->
=======
<p>In these networks, we see the interplay of processes internal and external to the system. Think of a transmission line malfunctioning in an electrical power grid. Or possibly a perturbation to a system that disrupts communication among nodes. These two examples hint at an important dynamical process termed cascading failure or avalanche (if you’re feeling fancy). Although rare, they can have severe consequences. In general, a cascading failure refers to some trigger mechanism that produces further failures in the system which ultimately may lead to a complete collapse of the system <span class="citation" data-cites="valdez2020jcn">(<a href="#ref-valdez2020jcn" role="doc-biblioref">Valdez et al., 2020</a>)</span>. Further failures occur because components vary in their ability to handle a certain load that is redistributed to them after an initial failure.</p>
<p>Similarly, in social systems we might think of a cascading failure being dependent on the information other people may have and subsequently their decisions. This is quite common in fads or things that are “hyped-up”. We might choose to wear Levi jeans because many of our peers are wearing Levi jeans. We might choose to see one movie over another based on reviews or recommendations by friends. Economists define these scenarios as <em>binary decisions with externalities</em><span class="citation" data-cites="watts2002p">(<a href="#ref-watts2002p" role="doc-biblioref">Watts, 2002</a>)</span>. Important to note is that a personal threshold must be reached before a transition occurs in conjunction with what others have decided. Furthermore, rather than components failing it is a component transitioning from one state to another.</p>
<p>Similarly, in social systems we might think of a cascading failure being dependent on the information other people may have and subsequently their decisions. This is quite common in fads or things that are “hyped-up”. We might choose to wear Levi jeans because many of our peers are wearing Levi jeans. We might choose to see one movie over another based on reviews or recommendations by friends. Economists define these scenarios as <em>binary decisions with externalities</em><span class="citation" data-cites="watts2002p">(<a href="#ref-watts2002p" role="doc-biblioref">Watts, 2002</a>)</span>. Important to note is that a personal threshold must be reached before a transition occurs in conjunction with what others have decided. Furthermore, rather than components failing it is a component transitioning from one state to another.</p>
>>>>>>> 753b4f1 (Hopefully the last update. Added degree distributions)
<p>Cascading failures leads us to questions such as:</p>
<ul>
<li><p>How does the structure of a network impact its resilience to failures?</p></li>
<li><p>How can we enhance a system to mitigate further cascading failures?</p></li>
<li><p>Where are the vulnerable components in a system. Are they the high-degree or low-degree nodes?</p></li>
<li><p>When do components transition states (i.e., at a well-defined threshold)?</p></li>
</ul>
<p>As an illustrative example:</p>
<div class="center">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/EnergyGrid.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<p>A group of students are running experiments and simulations in their respective labs. Suddenly a blackout occurs! Welp, there goes their precious research. Let’s explain to these poor students that a cascading failure may have occurred.</p>
<ol type="1">
<li><p>Overloading or zeroing of a component in the electrical power grid. <em>A group of Davis bikers crash into a substation</em>.</p></li>
<li><p>Power is redistributed from the failed component. There is an increase in the loadings of other components.</p></li>
<li><p>The system is stressed out and loadings are higher than the capacity of components. Leading to a cascading failure.</p></li>
<li><p>Blackout all around Davis.</p></li>
</ol>
</section>
<section id="recap-on-graph-structures" class="level1">
<h1>Recap on Graph Structures</h1>
<p>As we once touched on at some time point long ago, centrality measures can be meaningful if we know a network’s degree distribution. In a similar light, Bringmann and colleagues (2019) argued the relevance of centrality measures in psychology are dependent on how we’re modeling a given system. As we’ll see, the degree distribution of a network not only applies to centrality measures, but also in the context of cascading failures. If the degree distribution of our network follows a Erdős–Rényi graph, does it matter which node we choose to fail? How will a cascading failure differ if our graph is Barabási–Albert versus a Watts-Strogatz? Let’s look at these degree distributions more closely again.</p>
<section id="erdősrényi-random-graph" class="level2">
<h2 class="anchored" data-anchor-id="erdősrényi-random-graph">Erdős–Rényi random graph</h2>
<p>The Erdős–Rényi random graph is described as a distribution of graphs <span class="math inline">\(G(n, p)\)</span> where <span class="math inline">\(n\)</span> is the number of nodes in a graph and <span class="math inline">\(p\)</span> is the probability of an edge between two nodes.</p>
<p>From what we already learned, we know the degree distribution of this random graph is binomial. Think back to coin flip analogy. There is a <span class="math inline">\(p\)</span> probability of getting a heads (edge) and a 1-<span class="math inline">\(p\)</span> probability of tails (no edge).</p>
<p>This gives rise to the probability mass function: <span class="math display">\[P(\deg(v) = k) = \binom{n-1}{k} p^k (1 - p)^{n - 1 - k}\]</span></p>
<p>where <span class="math inline">\(k \in \{0, 1,\dots, (n-1)\}\)</span>. Additionally, if we take the average degree of a Erdős–Rényi random graph we would see that it is close to the <span class="math inline">\(\mathbb{E}[\deg(v)\)</span>. As an example, here we generate two random graphs with the same number of nodes with varying edge probability.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">g1 =</span> <span class="fu">sample_gnp</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">p =</span> <span class="fl">0.50</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">g2 =</span> <span class="fu">sample_gnp</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">p =</span> <span class="fl">0.90</span>))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(gs, plot))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_2_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Increasing p increases the average degree as shown below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">degree</span>(gs[[<span class="dv">1</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">degree</span>(gs[[<span class="dv">2</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.6</code></pre>
</div>
</div>
</section>
<section id="barabási-albert-random-graph" class="level2">
<h2 class="anchored" data-anchor-id="barabási-albert-random-graph">Barabási-Albert random graph</h2>
<p>If we remember, Barabási-Albert are graphs where nodes preferentially attach to already well-connected nodes. The degree distribution of this random graph follows a “power law”. Formally, this is <span class="math inline">\(P(k) \sim k^{-\gamma}\)</span>, where <span class="math inline">\(\gamma\)</span> is a scaling parameter in the range of <span class="math inline">\(2 &lt; \gamma &lt; 3\)</span>. Essentially this means many nodes will have few connections and few nodes will have a high degree.</p>
<p>The BA random graph is generated by way of the preferential attachment algorithm. The algorithm starts with a small fully connected network with <span class="math inline">\(|n_{0}|\)</span> nodes that then has nodes incrementally added. Each node will connect with a probability preferentially for high degree nodes as given below. The procedure repeats until we reach the total number of nodes in the graph.</p>
<p><span class="math display">\[\prod(i) = \frac{\deg(i)}{\sum_{j}\deg(j)}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ba<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">sample_pa</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">power =</span> <span class="dv">1</span>, <span class="at">m =</span> <span class="dv">3</span>, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ba<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_2_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="watts-strogatz-small-worlds" class="level2">
<h2 class="anchored" data-anchor-id="watts-strogatz-small-worlds">Watts-Strogatz Small-Worlds</h2>
<p>In this graph, nodes tend to all be relatively close to each other. Nodes can access any other node relatively fast. We see this in real-world networks as local clustering. Formally this graph is, <span class="math inline">\(G_{WS}(n, k, \beta)\)</span> where <span class="math inline">\(n\)</span> is the number of nodes, <span class="math inline">\(k\)</span> is the average degree, and <span class="math inline">\(\beta\)</span> is the rewiring probability for each edge. Rewiring probability assigns the edge to another node contingent on not already being connected to the node or creating a self-loop.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ws1 <span class="ot">=</span> <span class="fu">sample_smallworld</span>(<span class="at">dim =</span> <span class="dv">1</span>, <span class="at">nei =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">p =</span> <span class="fl">0.00</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ws1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interactive-display" class="level2">
<h2 class="anchored" data-anchor-id="interactive-display">Interactive Display</h2>
<section id="ba" class="level3">
<h3 class="anchored" data-anchor-id="ba">BA</h3>
<div class="cell">
<div class="cell-output-display">
<<<<<<< HEAD
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-4e601b0ec9f8111afa62" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-4e601b0ec9f8111afa62">{"x":{"nodes":{"id":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],"label":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"]},"edges":{"from":["2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],"to":["1","1","3","4","2","4","3","3","1","2","10","3","4","13","3","3","11","6","3"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"physics":{"stabilization":true},"interaction":{"dragNodes":true,"dragView":true,"zoomSpeed":1}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
=======
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-1f75322a0503dd47dc0e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1f75322a0503dd47dc0e">{"x":{"nodes":{"id":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],"label":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"]},"edges":{"from":["2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],"to":["1","1","1","2","1","6","1","7","1","1","1","11","11","1","2","1","1","1","16"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"physics":{"stabilization":true},"interaction":{"dragNodes":true,"dragView":true,"zoomSpeed":1}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
>>>>>>> 753b4f1 (Hopefully the last update. Added degree distributions)
</div>
</div>
</section>
<section id="er" class="level3">
<h3 class="anchored" data-anchor-id="er">ER</h3>
<div class="cell">
<div class="cell-output-display">
<<<<<<< HEAD
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-9b2532c3a4ed58d7b043" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9b2532c3a4ed58d7b043">{"x":{"nodes":{"id":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],"label":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"]},"edges":{"from":["1","3","1","2","3","1","4","5","1","2","3","4","5","1","2","4","6","2","3","5","7","1","2","5","1","2","4","6","7","9","10","3","5","6","7","8","10","3","4","5","6","7","8","11","12","5","7","9","11","13","2","4","6","7","8","9","3","4","6","8","10","13","14","3","4","5","7","8","9","10","12","15","2","3","6","9","10","11","14","3","4","11","12","13","16","17","18","1","2","5","6","10","12","15","17","18"],"to":["2","4","5","5","5","6","6","6","7","7","7","7","7","8","8","8","8","9","9","9","9","10","10","10","11","11","11","11","11","11","11","12","12","12","12","12","12","13","13","13","13","13","13","13","13","14","14","14","14","14","15","15","15","15","15","15","16","16","16","16","16","16","16","17","17","17","17","17","17","17","17","17","18","18","18","18","18","18","18","19","19","19","19","19","19","19","19","20","20","20","20","20","20","20","20","20"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"physics":{"stabilization":true},"interaction":{"dragNodes":true,"dragView":true,"zoomSpeed":1}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
=======
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-c74d9e7e9f5e928c33dd" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c74d9e7e9f5e928c33dd">{"x":{"nodes":{"id":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],"label":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"]},"edges":{"from":["1","2","1","2","4","1","3","4","2","3","4","3","5","7","1","2","6","8","3","4","5","6","7","9","1","2","6","8","9","1","2","4","5","6","8","10","11","1","3","4","5","7","8","1","2","3","5","8","9","10","2","6","11","12","13","1","2","4","5","6","8","9","12","13","15","2","4","6","8","10","12","13","16","1","2","3","5","7","8","12","15","16","3","7","10","13","14","15","16","17","2","4","5","8","10","15","16","17","19"],"to":["2","3","4","5","5","6","6","6","7","7","7","8","8","8","9","9","9","9","10","10","10","10","10","10","11","11","11","11","11","12","12","12","12","12","12","12","12","13","13","13","13","13","13","14","14","14","14","14","14","14","15","15","15","15","15","16","16","16","16","16","16","16","16","16","16","17","17","17","17","17","17","17","17","18","18","18","18","18","18","18","18","18","19","19","19","19","19","19","19","19","20","20","20","20","20","20","20","20","20"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"physics":{"stabilization":true},"interaction":{"dragNodes":true,"dragView":true,"zoomSpeed":1}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
>>>>>>> 753b4f1 (Hopefully the last update. Added degree distributions)
</div>
</div>
</section>
<section id="ws" class="level3">
<h3 class="anchored" data-anchor-id="ws">WS</h3>
<div class="cell">
<div class="cell-output-display">
<<<<<<< HEAD
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-f6001a0e2d19b0893c97" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f6001a0e2d19b0893c97">{"x":{"nodes":{"id":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],"label":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"]},"edges":{"from":["2","2","3","4","5","6","6","8","9","10","2","13","13","15","9","16","17","18","19","13","1","5","2","8","3","4","5","6","7","8","1","3","11","1","13","14","11","16","11","7"],"to":["4","5","4","5","17","7","12","20","12","11","16","14","16","19","17","17","18","19","20","18","3","18","20","15","5","6","7","8","9","18","4","10","13","14","15","16","17","18","20","8"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"physics":{"stabilization":true},"interaction":{"dragNodes":true,"dragView":true,"zoomSpeed":1}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<!-- -   Focus on re-describing the Erdős–Rényi and Barabási–Albert random graphs -->
<!--     -   With Barabási–Albert, talk more in-depth about preferential attachment and the "growth" of graphs -->
<!--     -   E.g., graphs in the real-world add and incorporate vertices over time and the addition of vertices follows some known procedures -->
<!--     -   Define the terms: Preferential attachment and Assortative mixing and how they relate to the evolution of a network's structure -->
=======
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-a2a9ca7e3d4b37a1da12" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a2a9ca7e3d4b37a1da12">{"x":{"nodes":{"id":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],"label":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"]},"edges":{"from":["10","3","3","4","1","6","9","9","1","11","11","11","13","5","8","2","17","1","11","2","1","1","1","2","3","4","5","8","1","3","9","2","1","14","9","14","15","16","7","7"],"to":["15","7","4","5","7","16","10","14","9","20","16","18","14","19","19","14","18","18","19","20","19","6","2","4","20","6","11","11","12","10","18","12","11","18","13","19","17","19","10","18"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"physics":{"stabilization":true},"interaction":{"dragNodes":true,"dragView":true,"zoomSpeed":1}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
>>>>>>> 753b4f1 (Hopefully the last update. Added degree distributions)
</section>
</section>
</section>
<section id="the-watts-model-for-cascading-failures" class="level1">
<h1>The Watt’s model for Cascading Failures</h1>
<p>As aforementioned, cascading failures can be thought of as the transitioning of a component from one state to another influenced by the state of neighboring components. The Watt’s model <span class="citation" data-cites="watts2002p">(<a href="#ref-watts2002p" role="doc-biblioref">Watts, 2002</a>)</span> focuses on small initial shocks relative to the size of the network that cascade into large failures of the system. An interesting aspect of cascading failures is that not all shocks result in a global cascade. As we’ll find out, some nodes have a higher threshold and therefore are less vulnerable. Or some nodes are simply less connected than other nodes despite being vulnerable. In short, it’s difficult to predict which node will result in a cascading failure without knowing the structure of the network.</p>
<section id="formal-definition-of-the-watts-model" class="level2">
<h2 class="anchored" data-anchor-id="formal-definition-of-the-watts-model">Formal Definition of the Watt’s model</h2>
<p>Formally, the Watt’s model can be described as a <em>simple binary decision rule with externalities</em>:</p>
<ol type="1">
<li><strong>We have a network of components</strong>, G = (<span class="math inline">\(C\)</span>, <span class="math inline">\(E\)</span>):</li>
</ol>
<ul>
<li><span class="math inline">\(C_i\)</span> observes the states of <span class="math inline">\(K\)</span> other components, essentially its <em>degree</em>.</li>
<li><span class="math inline">\(C_i\)</span> adopts state 1 if at least a threshold fraction (<span class="math inline">\(\phi\)</span>) of its <span class="math inline">\(K\)</span> neighbors are state 1, otherwise it stays inactive.</li>
</ul>
<ol start="2" type="1">
<li><strong>Component threshold</strong>:</li>
</ol>
<ul>
<li>To account for component variation, both the threshold and number of <span class="math inline">\(K\)</span> neighbors are allowed to be heterogeneous. Each component is assigned a threshold <span class="math inline">\(\phi\)</span> randomly drawn from a distribution <span class="math inline">\(f(\phi)\)</span> where <span class="math inline">\(f(\phi)\)</span> is a distribution defined on <span class="math inline">\([0,1]\)</span>, with <span class="math inline">\(\int_0^1 f(\phi) \, d\phi = 1\)</span>.</li>
</ul>
<ol start="3" type="1">
<li><strong>Network connection</strong>:</li>
</ol>
<ul>
<li>Each component is connected to <span class="math inline">\(K\)</span> neighbors with probability <span class="math inline">\(P_k\)</span> and the average number of neighbors is <span class="math inline">\(\langle k \rangle = z\)</span>. Simply, <span class="math inline">\(P_k\)</span> is the degree distribution of the graph and <span class="math inline">\(z\)</span> is the <em>average degree.</em></li>
</ul>
<ol start="4" type="1">
<li><strong>Modeling Dynamics of Cascades</strong></li>
</ol>
<ul>
<li>The population is initially all off (state 0) and perturbed at <span class="math inline">\(t\)</span> = 0 by a small fraction of <span class="math inline">\(\phi_0 \ll 1\)</span> that are switched to state 1.</li>
</ul>
<ol start="5" type="1">
<li><strong>Subsequent Steps:</strong></li>
</ol>
<ul>
<li>The system evolves at successive time steps with each component updating their state according to their threshold and the rule mentioned in <span class="math inline">\(\text{step 1}\)</span>. Once a component is active in this system it will stay active for the duration of time steps.</li>
</ul>
<p><strong>Important Considerations</strong></p>
<ul>
<li><em>Local dependencies</em> occur in that the threshold rule ensures a component’s state is determined by the states of neighboring nodes.</li>
<li><em>Fraction not a max</em>, the more signal one receives when making a choice, the less important the signal becomes. A key reason why we love In-N-Out’s short menu. In other words, the threshold rule does not take into account all of a component’s neighbors but a fraction.</li>
<li><em>A heterogeneous system</em>, this one is self-explanatory.</li>
</ul>
</section>
</section>
<section id="coding-the-watts-model" class="level1">
<h1>Coding the Watt’s Model</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Libraries</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="watts-cascade-function" class="level2">
<h2 class="anchored" data-anchor-id="watts-cascade-function">Watt’s cascade function</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cascade.Watts <span class="ot">=</span> <span class="cf">function</span>(g, <span class="at">thrsh.lim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.20</span>), <span class="at">max.steps =</span> <span class="dv">10000</span>){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  Cascades <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  metrics <span class="ot">=</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify the high, average, and low degree vertices</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  max_node <span class="ot">=</span> <span class="fu">which.max</span>(metrics)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">min</span>(metrics, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    min_node <span class="ot">=</span> <span class="fu">which.min</span>(<span class="fu">ifelse</span>(metrics <span class="sc">!=</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(metrics), metrics, <span class="dv">999</span>))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>(<span class="at">min_node =</span> <span class="fu">which.min</span>(<span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(metrics), metrics, <span class="dv">999</span>)))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  avg_node <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">which</span>(<span class="fu">abs</span>(metrics <span class="sc">-</span> <span class="fu">floor</span>(<span class="fu">mean</span>(metrics, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">abs</span>(metrics <span class="sc">-</span> <span class="fu">floor</span>(<span class="fu">mean</span>(metrics, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(metrics)), <span class="dv">1</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  seeds <span class="ot">=</span> <span class="fu">list</span>(<span class="at">high =</span> max_node, </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">avg =</span> avg_node,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">low =</span> min_node)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For the high, middle, and low vertices initiate a cascade</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(name <span class="cf">in</span> <span class="fu">names</span>(seeds)) {</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    target <span class="ot">=</span> seeds[[name]]</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(thrsh.lim[<span class="dv">1</span>] <span class="sc">&gt;</span> thrsh.lim[<span class="dv">2</span>]){</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="st">"First limit should be the lower limit! Flipping for you"</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>      thrsh.lim <span class="ot">=</span> <span class="fu">c</span>(thrsh.lim[<span class="dv">2</span>], thrsh.lim[<span class="dv">1</span>])</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Uniformly apply thresholds to all vertices between limits</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(g)<span class="sc">$</span>threshold <span class="ot">=</span> <span class="fu">runif</span>(<span class="fu">vcount</span>(g), <span class="at">min =</span> thrsh.lim[<span class="dv">1</span>], <span class="at">max =</span> thrsh.lim[<span class="dv">2</span>])</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(g)<span class="sc">$</span>state <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(g)<span class="sc">$</span>state[target] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    flip.count <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">sum</span>(<span class="fu">V</span>(g)<span class="sc">$</span>state))</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    step <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initiate Cascade</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span>(step <span class="sc">&lt;</span> max.steps) {</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>      step <span class="ot">=</span> step <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>      new.state <span class="ot">=</span> <span class="fu">V</span>(g)<span class="sc">$</span>state</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>      <span class="co"># For each vertex, check if it failed. If so, skip</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># If not, then identify its neighbors</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check how many of the current vertex's neighbors have failed relative to total</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Compare to threshold; if bigger then fail</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Repeat</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (v <span class="cf">in</span> <span class="fu">V</span>(g)) {</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">V</span>(g)<span class="sc">$</span>state[v] <span class="sc">==</span> <span class="dv">1</span>) <span class="cf">next</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        neighbors.v <span class="ot">=</span> <span class="fu">neighbors</span>(g, v)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(neighbors.v) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">next</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>          active_fraction <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">V</span>(g)<span class="sc">$</span>state[neighbors.v]) <span class="sc">/</span> <span class="fu">length</span>(neighbors.v)</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (active_fraction <span class="sc">&gt;=</span> <span class="fu">V</span>(g)<span class="sc">$</span>threshold[v]) {</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>          new.state[v] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">all</span>(new.state <span class="sc">==</span> <span class="fu">V</span>(g)<span class="sc">$</span>state)) <span class="cf">break</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">V</span>(g)<span class="sc">$</span>state <span class="ot">=</span> new.state</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>      flip.count <span class="ot">=</span> <span class="fu">c</span>(flip.count, <span class="fu">sum</span>(<span class="fu">V</span>(g)<span class="sc">$</span>state))</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    Cascades[[name]] <span class="ot">=</span> flip.count <span class="sc">/</span> <span class="fu">vcount</span>(g)</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(Cascades) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"High"</span>, <span class="st">"Average"</span>, <span class="st">"Low"</span>)</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Cascades)</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simulation-function" class="level2">
<h2 class="anchored" data-anchor-id="simulation-function">Simulation function</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation Function</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sim.funk <span class="ot">=</span> <span class="cf">function</span>(rep_id) {</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">3887891</span> <span class="sc">+</span> rep_id) </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  g_ba <span class="ot">=</span> <span class="fu">sample_pa</span>(<span class="at">n =</span> n_nodes, <span class="at">power =</span> <span class="dv">1</span>, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  g_er <span class="ot">=</span> <span class="fu">sample_gnm</span>(<span class="at">n =</span> n_nodes, <span class="at">m =</span> <span class="fu">ecount</span>(g_ba), <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  g_sw <span class="ot">=</span> <span class="fu">sample_smallworld</span>(<span class="at">dim =</span> <span class="dv">1</span>, <span class="at">size =</span> n_nodes, <span class="at">nei =</span> <span class="fu">floor</span>(<span class="fu">ecount</span>(g_ba)<span class="sc">/</span>n_nodes), <span class="at">p =</span> <span class="fl">0.05</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  ER.set <span class="ot">=</span> <span class="fu">cascade.Watts</span>(g_er, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>), <span class="dv">10000</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  BA.set <span class="ot">=</span> <span class="fu">cascade.Watts</span>(g_ba, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>), <span class="dv">10000</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  SW.set <span class="ot">=</span> <span class="fu">cascade.Watts</span>(g_sw, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>), <span class="dv">10000</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ER_high =</span> ER.set<span class="sc">$</span>High,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ER_avg  =</span> ER.set<span class="sc">$</span>Average,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ER_low  =</span> ER.set<span class="sc">$</span>Low,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">BA_high =</span> BA.set<span class="sc">$</span>High,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">BA_avg  =</span> BA.set<span class="sc">$</span>Average,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">BA_low  =</span> BA.set<span class="sc">$</span>Low,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">SW_high =</span> SW.set<span class="sc">$</span>High,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">SW_avg  =</span> SW.set<span class="sc">$</span>Average,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">SW_low  =</span> SW.set<span class="sc">$</span>Low</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot" class="level2">
<h2 class="anchored" data-anchor-id="plot">Plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial Parameters for Simulation</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>n_nodes <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use function</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">=</span> <span class="fu">sim.funk</span>(<span class="dv">1245</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>models <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"ER"</span>,<span class="st">"BA"</span>,<span class="st">"SW"</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>max_len <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>op <span class="ot">=</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(m <span class="cf">in</span> models) {</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">=</span> <span class="fu">grep</span>(<span class="fu">paste0</span>(<span class="st">"^"</span>, m, <span class="st">"_"</span>), <span class="fu">names</span>(results))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  raw <span class="ot">=</span> results[idx]</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">=</span> <span class="fu">sapply</span>(raw, <span class="cf">function</span>(v) {</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    L <span class="ot">=</span> <span class="fu">length</span>(v)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (L <span class="sc">&lt;</span> max_len) {</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(v, <span class="fu">rep</span>(v[L], max_len <span class="sc">-</span> L))</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>      v[<span class="dv">1</span><span class="sc">:</span>max_len]</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matplot</span>(<span class="dv">1</span><span class="sc">:</span>max_len, mat,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"o"</span>, <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">xlab =</span> <span class="st">"Step"</span>,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Prop. Failed"</span>,</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="fu">paste</span>(m, <span class="st">"model"</span>),</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, max_len),</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend =</span> <span class="fu">names</span>(results)[idx],</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="what-if-we-change-the-parameters" class="level2">
<h2 class="anchored" data-anchor-id="what-if-we-change-the-parameters">What if we change the parameters?</h2>
<section id="n-300-with-same-threshold" class="level3">
<h3 class="anchored" data-anchor-id="n-300-with-same-threshold">N = 300 with same threshold</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="n-30-with-threshold-between-.05-and-.9" class="level3">
<h3 class="anchored" data-anchor-id="n-30-with-threshold-between-.05-and-.9">N = 30, with threshold between .05 and .9</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="the-cascade-model-for-cascading-failures" class="level1">
<h1>The CASCADE model for Cascading Failures</h1>
<p>The CASCADE is a probabilistic model for understanding the propagation of cascading failures <span class="citation" data-cites="dobson2007caijons">(<a href="#ref-dobson2007caijons" role="doc-biblioref">Dobson et al., 2007</a>)</span>. It was developed to capture the weakening of a system as a cascade proceeds, particularly in the context of blackout of power transmitting systems, but made sufficiently simple and general that it could be applied to cascading failure in various large, interconnected infrastructures. CASCADE focuses on components failing when their load exceeds a threshold, how an initial disturbance loads the system, and how the failure of some components transfers additional load to others.</p>
<section id="formal-definition-of-the-cascade-model" class="level2">
<h2 class="anchored" data-anchor-id="formal-definition-of-the-cascade-model">Formal definition of the CASCADE model:</h2>
<p>The model considers a system with <span class="math inline">\(N\)</span> components, each with a random initial load.</p>
<ol type="1">
<li><strong>Initial load</strong> (<span class="math inline">\(L_j\)</span>):</li>
</ol>
<ul>
<li>Each component <span class="math inline">\(j\)</span> (for <span class="math inline">\(j = 1, 2, ..., N\)</span>) has an initial load <span class="math inline">\(L_j\)</span>.</li>
<li>The minimum value of a given load is <span class="math inline">\(L^{\text{min}}\)</span> and the maximum load is <span class="math inline">\(L^{\text{max}}\)</span>.</li>
<li><span class="math inline">\(L_{j}\)</span> is distributed uniformly between <span class="math inline">\([L^{\text{min}}, L^{\text{max}}]\)</span>.</li>
<li>The initial loads <span class="math inline">\(L_{1},L_{2},...,L_{N}\)</span> are independent of each other.</li>
</ul>
<ol start="2" type="1">
<li><strong>Failure threshold</strong> (<span class="math inline">\(L^\text{fail}\)</span>):</li>
</ol>
<ul>
<li>Components fail if their total load exceeds a certain failure threshold, <span class="math inline">\(L^\text{fail}\)</span></li>
</ul>
<ol start="3" type="1">
<li><strong>Load transfer</strong> (<span class="math inline">\(P\)</span>):</li>
</ol>
<ul>
<li>When a component fails, a fixed amount of additional load, <span class="math inline">\(P\)</span>, is transferred to each of the other remaining components in the system.</li>
</ul>
<ol start="4" type="1">
<li><strong>Initial disturbance</strong> (<span class="math inline">\(D\)</span>):</li>
</ol>
<ul>
<li>The cascade is initiated by an initial disturbance that adds an amount of load <span class="math inline">\(D\)</span> to each component.</li>
</ul>
<ol start="5" type="1">
<li><strong>Normalized initial load</strong> (<span class="math inline">\(\ell_{j}\)</span>):</li>
</ol>
<ul>
<li>The normalized initial load for the <span class="math inline">\(j^{th}\)</span> vertex is given by <span class="math inline">\(\ell_{j}\)</span> where:</li>
</ul>
<p><span class="math display">\[
  \ell_{j} = \frac{L_{j} - L^{\text{min}}}{L^{\text{max}} - L^{\text{min}}}
\]</span></p>
<ul>
<li>This normalization maps the load <span class="math inline">\(L_j\)</span> to a value <span class="math inline">\(\ell_{j}\)</span> that is uniformly distributed on the interval <span class="math inline">\([0,1]\)</span>.</li>
</ul>
<ol start="6" type="1">
<li><strong>Normalized parameters</strong>:</li>
</ol>
<ul>
<li>The load transfer <span class="math inline">\(P\)</span> and initial disturbance <span class="math inline">\(D\)</span> are also normalized. Let <span class="math inline">\(p\)</span> be the normalized load increment and <span class="math inline">\(d\)</span> be the normalized initial disturbance:</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
  p = &amp; \frac{P}{L^{\text{max}}-L^{\text{min}}} \\
  d = &amp; \frac{D + L^{\text{max}} - L^{\text{fail}}}{L^{\text{max}}-L^{\text{min}}}
\end{aligned}
\]</span></p>
<ol start="7" type="1">
<li><strong>Cascading process</strong>:</li>
</ol>
<ul>
<li>After the initial disturbance <span class="math inline">\(D\)</span>, components whose total load <span class="math inline">\((L_j+D)\)</span> exceeds <span class="math inline">\(L^{\text{fail}}\)</span> will fail.</li>
<li>The failure of these components then distributes an additional load <span class="math inline">\(P\)</span> (or <span class="math inline">\(p\)</span> in normalized terms) to other components, potentially causing further failures. This process continues iteratively, defining the cascade.</li>
</ul>
<!-- # Compare and Contrast Watts' Cascades from the CASCADE Model -->
<!-- > The Watt's description is more simplistic, vertices have no thresholds internal to themselves but are influenced entirely by neighbors. In the CASCADE model, vertices have resilience and an initial load such that they can exhibit more nuanced dynamics in how they fail -->
</section>
</section>
<section id="watts-cascades-vs.-cascade-model" class="level1">
<h1>Watt’s Cascades vs.&nbsp;CASCADE Model</h1>
<p>A brief distinction between the two models is that the Watt’s description is more simplistic: vertices have no thresholds internal to themselves but are influenced entirely by neighbors. In the CASCADE model, vertices have resilience and an initial load such that they can exhibit more nuanced dynamics in how they fail. Let’s break down their differences.</p>
<section id="thresholds-and-failure" class="level3">
<h3 class="anchored" data-anchor-id="thresholds-and-failure">Thresholds and Failure</h3>
<ul>
<li><p><strong>Watt’s model</strong>: Failure is determined by the fraction of a node’s <em>neighbors</em> that have already failed. A node <span class="math inline">\(i\)</span> with degree <span class="math inline">\(k_i\)</span> and threshold <span class="math inline">\(\phi_i\)</span> fails if at least a threshold fraction <span class="math inline">\(\phi\)</span> out of its <span class="math inline">\(k\)</span> neighbors are in state 1 (fail state), otherwise it adopts state 0. The threshold <span class="math inline">\(\phi_i\)</span> represents the node’s susceptibility to peer influence or stress from neighbors. Vertices do not have an internal “load” capacity in the same way as the CASCADE model; their failure is purely a response to the state of their local neighborhood.</p></li>
<li><p><strong>CASCADE</strong>: Failure is determined by a node’s internal load exceeding its predefined capacity (<span class="math inline">\(L^{\text{fail}}\)</span>). Nodes have an initial load <span class="math inline">\(L_j\)</span>, and this load increases due to an initial system-wide disturbance <span class="math inline">\(D\)</span> and subsequent load transfers <span class="math inline">\(P\)</span> from other failed components. The threshold is an absolute load limit, not directly dependent on the number or state of its neighbors in the topological sense.</p></li>
</ul>
</section>
<section id="influence-mechanism" class="level3">
<h3 class="anchored" data-anchor-id="influence-mechanism">Influence mechanism</h3>
<ul>
<li><p><strong>Watt’s model</strong>: Influence is local and topological. A node is influenced directly and only by the state (failed or not) of its immediate neighbors in the graph. What matters is the structure of the network (who is connected to whom).</p></li>
<li><p><strong>CASCADE</strong>: Influence is through load redistribution. When a node fails, it transfers a fixed load <span class="math inline">\(P\)</span> to other components. While the underlying network structure can be implicitly present in how loads might realistically be distributed, the primary mechanism is the global or semi-global impact of load addition.</p></li>
</ul>
</section>
<section id="vertex-properties" class="level3">
<h3 class="anchored" data-anchor-id="vertex-properties">Vertex properties</h3>
<ul>
<li><p><strong>Watt’s model</strong>: Vertices are primarily characterized by their degree <span class="math inline">\(k\)</span> and their individual threshold <span class="math inline">\(\phi\)</span>. There isn’t an explicit concept of “resilience” beyond the threshold itself.</p></li>
<li><p><strong>CASCADE</strong>: Vertices are characterized by their initial load <span class="math inline">\(L_j\)</span> and a common failure load <span class="math inline">\(L^{\text{fail}}\)</span>. The “resilience” of a node is the difference between its current load and <span class="math inline">\(L^{\text{fail}}\)</span>. Nodes can have different initial loads, making some inherently closer to failure than others even before the cascade begins. This implies that a node with a high initial load is more vulnerable.</p></li>
</ul>
</section>
<section id="complexity-of-dynamics" class="level3">
<h3 class="anchored" data-anchor-id="complexity-of-dynamics">Complexity of Dynamics</h3>
<ul>
<li><strong>Watt’s model</strong>: The dynamics are driven by changes in neighbor states. The “vulnerable” nodes (low threshold relative to degree) play a crucial role in initiating widespread cascades.
<ul>
<li>In the <em>low connectivity</em> regime, the network is sparse, and cascade propagation is mainly limited by connectivity. At the critical point (the system transitions from safe to vulnerable), cascade sizes follow a power law.</li>
<li>In the <em>high connectivity</em> regime the network is dense. The propagation of cascades is limited by the stability of individual nodes. Most nodes have many neighbors, making them less susceptible to single-node influence. This results in a bimodal distribution of cascade sizes: many small cascades that die out quickly and, rarely, extremely large global cascades.</li>
</ul></li>
<li><strong>CASCADE</strong>: The system dynamics are driven by accumulating load, with overall stress being a key factor. This stress depends on how close the initial loads are to the failure threshold (<span class="math inline">\(L^{\text{fail}}\)</span>) and the magnitudes of <span class="math inline">\(D\)</span> and <span class="math inline">\(P\)</span>. It examines the probability distribution of failed components and how this changes as system parameters, such as overall loading or load transfer (<span class="math inline">\(P\)</span>), approach a critical point.</li>
</ul>
<p>In summary, Watts’ model is more focused on the contagion of states through local, fractional influence within a network, where nodes don’t have intrinsic load capacities but rather susceptibility thresholds. The CASCADE model, conversely, emphasizes the accumulation of load on components that have defined capacities, where failure is a consequence of exceeding this capacity, leading to further load redistribution.</p>
<blockquote class="blockquote">
<p>Given these differences, which cascading failure model would be more appropriate to your research area?</p>
</blockquote>
</section>
<section id="can-we-know-the-thresholds-for-vertices" class="level2">
<h2 class="anchored" data-anchor-id="can-we-know-the-thresholds-for-vertices">Can We Know the Thresholds for Vertices?</h2>
<p>In the CASCADE model, the threshold is essentially defined by a node’s capacity and its load. In Watts’ model, the threshold (<span class="math inline">\(\phi\)</span>) for a node determines the fraction of its neighbors that must be “on” for it to switch “on.”</p>
<p>In <strong>engineered/physical systems</strong>, the thresholds can often be estimated or are known from design specifications. For example, a power line has a maximum current capacity, a router has a maximum data throughput, and a bridge has a maximum weight limit. These thresholds are based on physical properties and engineering design tolerances. However, even in these systems, thresholds can be dynamic, affected by environmental conditions (e.g., temperature affecting power line sag and capacity), aging, maintenance levels, or even “hidden failures” where a component’s actual capacity is less than assumed.</p>
<p>In <strong>social/economical/biological systems</strong> a threshold could relate to the point at which an individual or entity changes their behavior, opinion, or state due to influence from others or accumulated stress. In Watts’ model, this is the fraction of neighbors adopting a behavior that triggers an individual to also adopt it. For example, in decision making people could assume others have better information and follow their actions. It could also be the desire to align with the perceived majority or norm, or to be influenced by trusted sources. A biological “failure” can be illustrated by a PhD student who becomes overwhelmed and unable to progress with their research. In this scenario, the threshold could be influenced by factors such as the volume of TA responsibilities, the complexity of the research, and the level of support received from their advisor.</p>
<blockquote class="blockquote">
<p>What is a “threshold” for psychological vertices? Is it reasonable to assume psychological symptoms <em>have</em> thresholds for activation influenced by connected symptoms?</p>
</blockquote>
<details>
<summary>
An example of insomnia development.
</summary>
<p>Let’s consider insomnia as a complex system where various psychological and behavioral factors interact. We can conceptualize the transition into a state of chronic insomnia, or the worsening of its symptoms, as a form of cascading failure within an individual’s “sleep regulation network.” Let’s build our example using the popular <strong>3P model</strong> <span class="citation" data-cites="spielmanBehavioralPerspectiveInsomnia1987">(<a href="#ref-spielmanBehavioralPerspectiveInsomnia1987" role="doc-biblioref">Spielman et al., 1987</a>)</span>:</p>
<ul>
<li><p><strong>Predisposing Factors</strong>: These are like the initial conditions or inherent vulnerabilities of certain nodes in our network. Think of genetic propensity, a tendency towards ruminative thoughts, or a generally anxious disposition. These factors don’t cause insomnia on their own but lower the “failure threshold” of certain psychological states. For example, a “ruminative thought” node might have a naturally lower threshold to become “active” (i.e., start interfering with sleep).</p></li>
<li><p><strong>Precipitating Factors</strong>: These are the initial “shocks” or “failures” in the system. A stressful life event, a temporary illness, or a change in routine could be a precipitating factor that “activates” or “causes the failure” of an initial set of nodes – perhaps leading to a few nights of poor sleep. In our cascade model, this is the initial <span class="math inline">\(\phi_0\)</span> of “failed” nodes.</p></li>
<li><p><strong>Perpetuating Factors</strong>: These are crucial for the “cascade.” These are behaviors and beliefs adopted to cope with initial sleep disturbance but end up reinforcing and exacerbating it.</p></li>
<li><p>Take, for example, the node “Excessive Time in Bed”: An individual experiences a few nights of poor sleep (precipitating factor). To compensate, they start spending excessive time in bed (a perpetuating behavior). This “Excessive Time in Bed” node now becomes “active.”</p></li>
<li><p>Neighboring Nodes &amp; Thresholds:</p></li>
<li><p>This “Excessive Time in Bed” node influences other nodes, like “Sleep Fragmentation” and “Weakened Sleep-Wake Cycle.”</p></li>
<li><p>The “Sleep Fragmentation” node might have a threshold: if “Excessive Time in Bed” is active AND, say, “Anxiety about Sleep” (another node, perhaps activated by the precipitating factor) is also active, its threshold is met, and it “fails” (sleep becomes more fragmented).</p></li>
<li><p>The “Weakened Sleep-Wake Cycle” node might fail if “Excessive Time in Bed” stays active for a certain duration or intensity.</p></li>
</ul>
</details>
</section>
</section>
<section id="weave-in-graph-structures" class="level1">
<h1>Weave in Graph Structures</h1>
<section id="contrasting-erdősrényi-and-barabásialbert-random-graphs" class="level2">
<h2 class="anchored" data-anchor-id="contrasting-erdősrényi-and-barabásialbert-random-graphs">Contrasting Erdős–Rényi and Barabási–Albert random graphs</h2>
<section id="erdősrényi-er-graphs" class="level3">
<h3 class="anchored" data-anchor-id="erdősrényi-er-graphs">Erdős–Rényi (ER) Graphs</h3>
<p>In ER graphs, most nodes have a similar number of connections.</p>
<ul>
<li><p>They are relatively resilient to the random removal of a few nodes because the connectivity is distributed relatively evenly. A cascade might be triggered if a critical density of nodes fails, overwhelming the capacity of the remaining network.</p></li>
<li><p>Since there are no specific “super-hubs,” targeted attacks are not dramatically more effective than random failures unless a significant number of nodes are removed to fragment the network or the attack specifically targets a set of nodes that, if removed, would overload their collective neighbors beyond a critical point.</p></li>
<li><p>Once a cascade starts, it might spread more diffusely due to the homogeneity. However, if the overall network is stressed (e.g., low tolerance parameters in capacity models), even this diffuse spread can lead to widespread failure.</p></li>
</ul>
</section>
<section id="barabásialbert-ba-graphs" class="level3">
<h3 class="anchored" data-anchor-id="barabásialbert-ba-graphs">Barabási–Albert (BA) Graphs</h3>
<p>BA graphs are characterized by a few high-degree “hubs” (specific nodes that are highly connected) and many low-degree nodes.</p>
<ul>
<li><p>Removing a random (likely low-degree) node typically has little impact on the overall network integrity because the hubs maintain connectivity.</p></li>
<li><p>However, they are more vulnerable to the targeted failure of their hubs. Since hubs are connected to a large number of other nodes and often handle significant portions of network flow or influence, their failure can:</p></li>
</ul>
<ol type="1">
<li>Disconnect large parts of the network.</li>
<li>Cause a massive redistribution of load onto their neighbors, which are often less capable of handling such an increase, thereby triggering a cascade.</li>
</ol>
<ul>
<li>Contrary to ER networks, cascades in BA networks can be rapid and devastating. The heterogeneity of node loads means that some nodes are inherently much more critical than others. There can be a large range of tolerance parameters where scale-free networks are stable against random removals but unstable with respect to load-based removals of the highest-load nodes.</li>
</ul>
<!-- -   Do you expect Erdős–Rényi and Barabási–Albert random graphs to exhibit different properties in their susceptibility to cascading failures? Why? -->
<!-- -   For Barabási–Albert random graphs, do you expect the property of assortivity to come into play? -->
<!--     -   The fact is, when real-world networks develop, they build in structural stability to be resilient to failure. Assortivity can be a tool for this. Explain. -->
<section id="assortativeness-in-barabásialbert-graphs" class="level4">
<h4 class="anchored" data-anchor-id="assortativeness-in-barabásialbert-graphs">Assortativeness in Barabási–Albert Graphs</h4>
<blockquote class="blockquote">
<p>“A network displays assortative mixing if the nodes in the networks that have many connections tend to be connected to other nodes with many connections. A network is said to be disassortative if the highly connected nodes tend to be connected to nodes with few connections.” <span class="citation" data-cites="ash2007pasmaia">(<a href="#ref-ash2007pasmaia" role="doc-biblioref">Ash &amp; Newth, 2007, p. 6</a>)</span></p>
</blockquote>
<p>Recall the “rich get richer” property of BA graphs. That means that high-degree nodes tend to connect to many low-degree nodes. That means the BA graph is generally resilient up to the point that the hub fails.</p>
<p>The failure of a hub immediately affects a large number of low-degree nodes, potentially isolating them or overloading them if they were dependent on it. Cascades might spread outwards from a failed hub to its many low-degree neighbors.</p>
</section>
</section>
</section>
<section id="real-world-networks-stability" class="level2">
<h2 class="anchored" data-anchor-id="real-world-networks-stability">Real-world networks’ stability</h2>
<p>Instead of purely random or preferential attachment, real-world networks can be grown with resilience in mind. This might involve selectively adding redundant links, reinforcing nodes that are becoming too critical, or ensuring that new nodes connect in ways that don’t overly stress existing components. Assortativity can be a tool for this:</p>
<ul>
<li><p>By having important nodes (hubs) connect to each other, a robust core can be formed. If one hub in this core fails, other hubs within the core might be able to take up the slack or maintain critical pathways. This can create a resilient core.</p></li>
<li><p>In naturally disassortative networks, recognizing that hubs connect to many low-degree, dependent nodes allows for targeted protection strategies.</p></li>
<li><p>This structure can also help in “islanding” or modularizing failures. If the core is highly interconnected but has sparser connections to the periphery, a failure within the core might be devastating to the core itself but could potentially be prevented from spreading extensively to the rest of the network if the inter-modular connections are managed or severed. A failure within one module can be contained, preventing a global cascade.</p></li>
<li><p>High clustering provides alternative pathways through which flows can pass, avoiding the failed component.</p></li>
<li><p>Longer path lengths also promote robustness of the network. A disturbance needs to pass through a greater number of intermediate steps before the entire network is exposed to failure. Longer delays increase the change the network will resolve the perturbation.</p></li>
</ul>
<section id="the-brain-as-an-example-of-a-disassortative-network" class="level4">
<h4 class="anchored" data-anchor-id="the-brain-as-an-example-of-a-disassortative-network">The brain as an example of a Disassortative Network</h4>
<ul>
<li><p>Certain control systems (hubs) in the brain might manage specific functions (loners).</p></li>
<li><p>If such a control system (hub) fails, the downstream dependent functions (loners) will fail. However, this failure might be contained within that “module” without causing catastrophic failure of the entire system (e.g., damage to the occipital lobe causes loss of sight, not death).</p></li>
<li><p>This disassortative structure can be a form of modular redundancy, preventing cascades from spreading throughout the entire system.</p></li>
</ul>
</section>
</section>
</section>
<section id="coding-load-based-models" class="level1">
<h1>Coding load-based models</h1>
<ul>
<li><p><strong>Nodes</strong>, <span class="math inline">\(j = 1, 2, 3, \ldots N\)</span>, have an initial load, <span class="math inline">\(L_j\)</span>, and capacity, <span class="math inline">\(C_j\)</span>.</p></li>
<li><p>The <strong>initial load</strong> is calculated based on node degree, <span class="math inline">\(k_j\)</span>, and adjustable parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, that control the intensity of the initial load on nodes: <span class="math inline">\(L_j = \beta k^{\alpha}_j\)</span>.</p></li>
<li><p>The <strong>capacity</strong> <span class="math inline">\(C_j\)</span> of each node is proportional to its initial load and a tolerance factor, <span class="math inline">\(T\)</span>: <span class="math inline">\(C_j = L_j \cdot T\)</span>. If <span class="math inline">\(T = 1.2\)</span>, nodes can handle 20% more than their initial load.</p></li>
<li><p>Node <span class="math inline">\(j\)</span> will <strong>fail</strong> when the load it receives plus the initial load on its own node is greater than its processing capacity, <span class="math inline">\(L_j + L_{ji} &gt; C_j\)</span></p></li>
<li><p>When a node fails, its current load is <strong>redistributed</strong> among its still active neighbors. The redistribution is preferential: neighbors with higher degrees (or a function of degree related to <span class="math inline">\(\alpha\)</span>) receive a larger fraction of the failed node’s load: <span class="math inline">\(\Delta L_{ji} = L_i \frac{k_j^{\alpha}}{\underset{n \in r_i}{\sum}k_n^{\alpha}}\)</span>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">### "Complex" Xiang Cascade </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>cascade.Xiang <span class="ot">=</span> <span class="cf">function</span>(g, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">T =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">max.steps =</span> <span class="dv">10000</span>) {</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="fu">vcount</span>(g)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  deg <span class="ot">=</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load is based on beta, alpha, and degree</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  load0 <span class="ot">=</span> beta <span class="sc">*</span> (deg<span class="sc">^</span>alpha)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">=</span> T <span class="sc">*</span> load0</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Choose high, average, and lowest degree vertices</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  high <span class="ot">=</span> <span class="fu">which.max</span>(deg)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  low <span class="ot">=</span> <span class="fu">which.min</span>(deg)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  avg <span class="ot">=</span> <span class="fu">which.min</span>(<span class="fu">abs</span>(deg <span class="sc">-</span> <span class="fu">mean</span>(deg)))[<span class="dv">1</span>]</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  seeds <span class="ot">=</span> <span class="fu">list</span>(<span class="at">High=</span>high, <span class="at">Average=</span>avg, <span class="at">Low=</span>low)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">=</span> <span class="fu">lapply</span>(seeds, <span class="cf">function</span>(seed) {</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    load <span class="ot">=</span> load0</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    failed <span class="ot">=</span> <span class="fu">logical</span>(N)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kill the target</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find neighbors</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Distribute failure to other neighbors</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># High degree neighbors take more load</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    failed[seed] <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    nbrs <span class="ot">=</span> <span class="fu">as.integer</span>(<span class="fu">neighbors</span>(g,seed))</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(nbrs)) {</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>      wts <span class="ot">=</span> deg[nbrs]<span class="sc">^</span>alpha</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>      load[nbrs] <span class="ot">=</span> load[nbrs] <span class="sc">+</span> load[seed]<span class="sc">*</span>(wts<span class="sc">/</span><span class="fu">sum</span>(wts))</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    load[seed] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    series <span class="ot">=</span> <span class="fu">sum</span>(failed)<span class="sc">/</span>N</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (t <span class="sc">&lt;</span> max.steps) {</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>      to_fail <span class="ot">=</span> <span class="fu">which</span>(<span class="sc">!</span>failed <span class="sc">&amp;</span> (load <span class="sc">&gt;</span> cap))</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">length</span>(to_fail)) <span class="cf">break</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (v <span class="cf">in</span> to_fail) {</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>        failed[v] <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>        nbrs2 <span class="ot">=</span> <span class="fu">setdiff</span>(<span class="fu">as.integer</span>(<span class="fu">neighbors</span>(g,v)), <span class="fu">which</span>(failed))</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(nbrs2)) {</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>          w2 <span class="ot">=</span> deg[nbrs2]<span class="sc">^</span>alpha</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>          load[nbrs2] <span class="ot">=</span> load[nbrs2] <span class="sc">+</span> load[v]<span class="sc">*</span>(w2<span class="sc">/</span><span class="fu">sum</span>(w2))</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>        load[v] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>      t <span class="ot">=</span> t<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>      series[t] <span class="ot">=</span> <span class="fu">sum</span>(failed)<span class="sc">/</span>N</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    series</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(results) <span class="ot">=</span> <span class="fu">names</span>(seeds)</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  results</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sim.funk <span class="ot">=</span> <span class="cf">function</span>(rep_id, n_nodes) {</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">15846</span> <span class="sc">+</span> rep_id) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  g_ba <span class="ot">=</span> <span class="fu">sample_pa</span>(<span class="at">n =</span> n_nodes, <span class="at">power =</span> <span class="dv">1</span>, <span class="at">m =</span> <span class="dv">2</span>, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  g_er <span class="ot">=</span> <span class="fu">sample_gnm</span>(<span class="at">n =</span> n_nodes, <span class="at">m =</span> <span class="fu">ecount</span>(g_ba), <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  g_sw <span class="ot">=</span> <span class="fu">sample_smallworld</span>(<span class="at">dim =</span> <span class="dv">1</span>, <span class="at">size =</span> n_nodes, <span class="at">nei =</span> <span class="fu">floor</span>(<span class="fu">ecount</span>(g_ba)<span class="sc">/</span>n_nodes), <span class="at">p =</span> <span class="fl">0.05</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  ER.set <span class="ot">=</span> <span class="fu">cascade.Xiang</span>(g_er, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">T =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">max.steps =</span> <span class="dv">1000</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  BA.set <span class="ot">=</span> <span class="fu">cascade.Xiang</span>(g_ba, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">T =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">max.steps =</span> <span class="dv">1000</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  SW.set <span class="ot">=</span> <span class="fu">cascade.Xiang</span>(g_sw, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">T =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">max.steps =</span> <span class="dv">1000</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">ER_high =</span> ER.set<span class="sc">$</span>High,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ER_avg  =</span> ER.set<span class="sc">$</span>Average,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ER_low  =</span> ER.set<span class="sc">$</span>Low,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">BA_high =</span> BA.set<span class="sc">$</span>High,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">BA_avg  =</span> BA.set<span class="sc">$</span>Average,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">BA_low  =</span> BA.set<span class="sc">$</span>Low,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">SW_high =</span> SW.set<span class="sc">$</span>High,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">SW_avg  =</span> SW.set<span class="sc">$</span>Average,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">SW_low  =</span> SW.set<span class="sc">$</span>Low</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>n_nodes <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">=</span> <span class="fu">sim.funk</span>(<span class="dv">34</span>, <span class="at">n_nodes =</span> n_nodes)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>models <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"ER"</span>,<span class="st">"BA"</span>,<span class="st">"SW"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>max_len <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>op <span class="ot">=</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(m <span class="cf">in</span> models) {</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">=</span> <span class="fu">grep</span>(<span class="fu">paste0</span>(<span class="st">"^"</span>, m, <span class="st">"_"</span>), <span class="fu">names</span>(results))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  raw <span class="ot">=</span> results[idx]</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">=</span> <span class="fu">sapply</span>(raw, <span class="cf">function</span>(v) {</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    L <span class="ot">=</span> <span class="fu">length</span>(v)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (L <span class="sc">&lt;</span> max_len) {</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(v, <span class="fu">rep</span>(v[L], max_len <span class="sc">-</span> L))</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>      v[<span class="dv">1</span><span class="sc">:</span>max_len]</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matplot</span>(<span class="dv">1</span><span class="sc">:</span>max_len, mat,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"o"</span>, <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">xlab =</span> <span class="st">"Step"</span>,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Prop. Failed"</span>,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="fu">paste</span>(m, <span class="st">"model"</span>),</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, max_len),</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend =</span> <span class="fu">names</span>(results)[idx],</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="what-do-we-see" class="level3">
<h3 class="anchored" data-anchor-id="what-do-we-see">What do we see?</h3>
<ul>
<li><p><strong>ER &amp; SW</strong>: Tend to show more uniform failure patterns. The specific starting node (high, avg, low degree) has less differential impact because connectivity is more homogeneous. SW models might take longer to fail completely due to their lattice-like local structure.</p></li>
<li><p><strong>BA</strong>: Show significant heterogeneity. Failing a high-degree hub often leads to rapid and extensive cascades, potentially total failure. Failing a low-degree node might have minimal impact. This is because hubs are often the sole connection for many other nodes.</p></li>
</ul>
<p>The choice of which “central” node to target for intervention or to study for failure initiation only makes sense after you understand the network’s underlying degree distribution (topology). Targeting a high-degree node is critical in a power-law network but less so in an ER network.</p>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<ul>
<li><p>In a electrical power grid, repairs of damaged equipment, frequent maintenance, equipment replacement with more potent ones, or using alarm systems, are some response options to reduce the probability of blackouts. In psychological networks,</p>
<ul>
<li>What could be an example of a weak system?</li>
<li>What could be mitigation and reinforcement strategies to prevent or contain cascades? How to identify and reinforce critical components?</li>
</ul></li>
</ul>
</section>
<section id="disclaimer" class="level1">
<h1>Disclaimer</h1>
<p>MC used AI to help with grammar and to generate ideas.</p>
</section>
<section id="references" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-ash2007pasmaia" class="csl-entry" role="listitem">
Ash, J., &amp; Newth, D. (2007). Optimizing complex networks for resilience against cascading failure. <em>Physica A: Statistical Mechanics and Its Applications</em>, <em>380</em>, 673–683. <a href="https://doi.org/10.1016/j.physa.2006.12.058">https://doi.org/10.1016/j.physa.2006.12.058</a>
</div>
<div id="ref-dobson2007caijons" class="csl-entry" role="listitem">
Dobson, I., Carreras, B. A., Lynch, V. E., &amp; Newman, D. E. (2007). Complex systems analysis of series of blackouts: <span>Cascading</span> failure, critical points, and self-organization. <em>Chaos: An Interdisciplinary Journal of Nonlinear Science</em>, <em>17</em>(2), 026103. <a href="https://doi.org/10.1063/1.2737822">https://doi.org/10.1063/1.2737822</a>
</div>
<div id="ref-spielmanBehavioralPerspectiveInsomnia1987" class="csl-entry" role="listitem">
Spielman, A. J., Caruso, L. S., &amp; Glovinsky, P. B. (1987). A behavioral perspective on insomnia treatment. <em>The Psychiatric Clinics of North America</em>, <em>10</em>(4), 541–553. <a href="https://www.ncbi.nlm.nih.gov/pubmed/3332317">https://www.ncbi.nlm.nih.gov/pubmed/3332317</a>
</div>
<div id="ref-valdez2020jcn" class="csl-entry" role="listitem">
Valdez, L. D., Shekhtman, L., La Rocca, C. E., Zhang, X., Buldyrev, S. V., Trunfio, P. A., Braunstein, L. A., &amp; Havlin, S. (2020). Cascading failures in complex networks. <em>Journal of Complex Networks</em>, <em>8</em>(2), cnaa013. <a href="https://doi.org/10.1093/comnet/cnaa013">https://doi.org/10.1093/comnet/cnaa013</a>
</div>
<div id="ref-watts2002p" class="csl-entry" role="listitem">
Watts, D. J. (2002). A simple model of global cascades on random networks. <em>PNAS</em>, <em>9</em>(99). <a href="https://doi.org/10.1073 pnas.082090499">https://doi.org/10.1073 pnas.082090499</a>
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>